Решения по архитектуре osago-aggregator
Выделение отдельного сервиса osago-aggregator
Отвечает за отправку заявок в страховые компании и их мониторинг.
Обеспечивает асинхронное получение предложений.
Хранение данных в osago-aggregator
Требуется база данных (PostgreSQL или Redis) для хранения состояния заявок.
Позволяет избежать дублирования запросов и обеспечивать повторный опрос.
API между core-app и osago-aggregator
core-app отправляет заявку в osago-aggregator через Kafka (Event-Driven).
osago-aggregator публикует ответы от страховых компаний в Kafka, откуда core-app получает предложения и сразу отображает их пользователю.
Средство интеграции между веб-приложением и core-app
WebSocket API – для мгновенного обновления экрана клиента по мере поступления предложений.
REST API – для получения полного списка предложений (если клиент обновит страницу).
Применение паттернов отказоустойчивости
Rate Limiting – ограничение запросов к osago-aggregator и API страховых компаний.
Circuit Breaker – предотвращает перегрузку при отказах API страховых компаний.
Retry + Timeout – osago-aggregator использует автоматический ретрай в случае временных ошибок.
Parallel Requests – осаго-агрегатор делает запросы параллельно ко всем страховым компаниям для ускорения ответа.

Ожидаемые улучшения

✅ Мгновенное отображение предложений на экране клиента.
✅ Гарантированное получение ответов от всех страховых компаний в течение 60 секунд.
✅ Гибкость и масштабируемость – легко добавлять новых страховщиков без изменений в core-app.
✅ Снижение нагрузки на API страховых за счет Rate Limiting и Circuit Breaker.